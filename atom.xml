<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>爱谁谁</title>
  <icon>https://www.aisheishei.com/icon.png</icon>
  
  <link href="https://www.aisheishei.com/atom.xml" rel="self"/>
  
  <link href="https://www.aisheishei.com/"/>
  <updated>2024-12-25T04:12:08.455Z</updated>
  <id>https://www.aisheishei.com/</id>
  
  <author>
    <name>ta_shuo</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>nestjs-typeorm树形查询</title>
    <link href="https://www.aisheishei.com/2023/09/01/nestjs-db-tree-query/"/>
    <id>https://www.aisheishei.com/2023/09/01/nestjs-db-tree-query/</id>
    <published>2023-09-01T12:30:39.000Z</published>
    <updated>2024-12-25T04:12:08.455Z</updated>
    
    
    <summary type="html">&lt;h3 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h3&gt;&lt;p&gt;树形结构是一种常用的存储查询模型，比如后台菜单或评论列表，展开就是一棵树，对于数据库的表来讲，意味着自引用，即有一个外键字段关联本表的主键，该外键字段一般称为&lt;code&gt;parent_id&lt;/code&gt;，由该字段串联起整颗树的结构，在数据量不大的场景中，单纯一个&lt;code&gt;parent_id&lt;/code&gt;即可胜任树形数据的查询，只需对全表数据循环遍历组装，这种方案在前者后台菜单中比较常用…&lt;/p&gt;
&lt;p&gt;当数据超过一定量级，一次性load全部数据并循环遍历对于io和cpu都是很大的负担也不现实，此时一般增加辅助字段来提升查询性能(空间换时间)，以及满足更多样性的查询需求。这里只介绍一种常用的方案-&lt;code&gt;path&lt;/code&gt;，类似于unix的文件夹层级，该字段存储从根节点到该节点的整条路径，比如&lt;code&gt;100.120.200.&lt;/code&gt;：代表这棵树根节点为100，该节点为200，该节点的父节点为120，最大的好处是比单纯的&lt;code&gt;parent_id&lt;/code&gt;更容易获取任意节点的所有子节点&lt;/p&gt;
&lt;p&gt;很多orm都内置了树形模型方案，包括typeorm，具体可查看文档&lt;a href=&quot;https://typeorm.io/tree-entities&quot;&gt;Tree Entities&lt;/a&gt;，而&lt;code&gt;Materialized Path&lt;/code&gt;就是上述&lt;code&gt;path&lt;/code&gt;方案的实现，开箱即用&lt;/p&gt;
&lt;h3 id=&quot;问题&quot;&gt;&lt;a href=&quot;#问题&quot; class=&quot;headerlink&quot; title=&quot;问题&quot;&gt;&lt;/a&gt;问题&lt;/h3&gt;&lt;p&gt;不同场景有不同的方案需求，我们限定当前的需求是评论列表，结合当前各大平台如知乎的交互方案，更细化的需求是&lt;strong&gt;二级评论列表(非完整树形)，第一层为所有的一级评论，一级评论分页加载所有的子评论&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;继续看typeorm提供的查询方案，有几个相关的方法：&lt;code&gt;findTrees&lt;/code&gt;、&lt;code&gt;findRoots&lt;/code&gt;、&lt;code&gt;findDescendants&lt;/code&gt;、和&lt;code&gt;findDescendantsTree&lt;/code&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;findTrees&lt;/code&gt;：一次性返回所有的评论树&lt;/li&gt;
&lt;li&gt;&lt;code&gt;findRoots&lt;/code&gt;：一次性返回所有的根节点&lt;/li&gt;
&lt;li&gt;&lt;code&gt;findDescendants&lt;/code&gt;/&lt;code&gt;findDescendantsTree&lt;/code&gt;：返回一棵树</summary>
    
    
    
    <category term="typescript" scheme="https://www.aisheishei.com/categories/typescript/"/>
    
    <category term="nestjs" scheme="https://www.aisheishei.com/categories/typescript/nestjs/"/>
    
    
    <category term="typeorm" scheme="https://www.aisheishei.com/tags/typeorm/"/>
    
    <category term="tree" scheme="https://www.aisheishei.com/tags/tree/"/>
    
  </entry>
  
  <entry>
    <title>浅谈原型链</title>
    <link href="https://www.aisheishei.com/2023/07/12/javascript-prototype/"/>
    <id>https://www.aisheishei.com/2023/07/12/javascript-prototype/</id>
    <published>2023-07-13T02:00:58.000Z</published>
    <updated>2024-12-23T02:53:45.287Z</updated>
    
    
    <summary type="html">&lt;h3 id=&quot;上题&quot;&gt;&lt;a href=&quot;#上题&quot; class=&quot;headerlink&quot; title=&quot;上题&quot;&gt;&lt;/a&gt;上题&lt;/h3&gt;&lt;p&gt;先上前菜看段代码，思考以下几个问题&lt;/p&gt;
&lt;figure class=&quot;highlight typescript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# test.&lt;span class=&quot;property&quot;&gt;ts&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title class_&quot;&gt;Thing&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  born = &lt;span class=&quot;function&quot;&gt;() =&amp;gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;time to born&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;title function_&quot;&gt;die&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;time to die&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title class_&quot;&gt;Animal&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title class_ inherited__&quot;&gt;Thing&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;name&lt;/span&gt;: &lt;span class=&quot;built_in&quot;&gt;string&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;title function_&quot;&gt;constructor&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;name = &lt;span class=&quot;string&quot;&gt;&amp;quot;dog&amp;quot;&lt;/span&gt;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;variable language_&quot;&gt;super&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;property&quot;&gt;name&lt;/span&gt; = name;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  eat = &lt;span class=&quot;function&quot;&gt;() =&amp;gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;eat&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;title function_&quot;&gt;say&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;`Hi, i&amp;#x27;m &lt;span class=&quot;subst&quot;&gt;$&amp;#123;&lt;span class=&quot;variable language_&quot;&gt;this&lt;/span&gt;.name&amp;#125;&lt;/span&gt;`&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; cat = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;title class_&quot;&gt;Animal&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;quot;cat&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; dog = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;title class_&quot;&gt;Thing&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;以下几个的值分别是什么&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;Object.getOwnPropertyNames(cat)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Object.getOwnPropertyNames(dog)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Object.getOwnPropertyNames(Object.getPrototypeOf(cat))&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Object.getOwnPropertyNames(Object.getPrototypeOf(dog))&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Object.getOwnPropertyNames(Animal)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Object.getOwnPropertyNames(Thing)&lt;/code&gt;</summary>
    
    
    
    <category term="typescript" scheme="https://www.aisheishei.com/categories/typescript/"/>
    
    <category term="javascript" scheme="https://www.aisheishei.com/categories/typescript/javascript/"/>
    
    
    <category term="prototype" scheme="https://www.aisheishei.com/tags/prototype/"/>
    
    <category term="原型链" scheme="https://www.aisheishei.com/tags/%E5%8E%9F%E5%9E%8B%E9%93%BE/"/>
    
  </entry>
  
  <entry>
    <title>nest命令行工具</title>
    <link href="https://www.aisheishei.com/2023/07/09/nest-command-tool/"/>
    <id>https://www.aisheishei.com/2023/07/09/nest-command-tool/</id>
    <published>2023-07-09T15:30:53.000Z</published>
    <updated>2024-12-23T02:53:45.289Z</updated>
    
    
    <summary type="html">&lt;h3 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h3&gt;&lt;p&gt;&lt;code&gt;nest&lt;/code&gt;官方未提供自定义命令的模块，所以出现很多功能丰富的第三方库，比如的有&lt;a href=&quot;https://github.com/Pop-Code/nestjs-console&quot;&gt;nestjs-console&lt;/a&gt;(基于&lt;a href=&quot;https://github.com/tj/commander.js&quot;&gt;commande&lt;/a&gt;)、&lt;a href=&quot;https://gitlab.com/aa900031/nestjs-command&quot;&gt;nestjs-command&lt;/a&gt;(基于&lt;a href=&quot;https://github.com/yargs/yargs&quot;&gt;yargs&lt;/a&gt;)，两者都提供了完善的命令行工具所需配置，引入项目及使用也很方便，但都不支持批量注册命令，每个命令的注册都要提供完整的配置信息，对于某些场景可能不是特别合适(比如偷懒)，所以奔着学习的目的新开一个项目实现缺失的功能&lt;/p&gt;
&lt;h3 id=&quot;开发&quot;&gt;&lt;a href=&quot;#开发&quot; class=&quot;headerlink&quot; title=&quot;开发&quot;&gt;&lt;/a&gt;开发&lt;/h3&gt;&lt;p&gt;整个项目功能非常简单，逻辑也很清晰，主要有以下三点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;遍历出&lt;code&gt;nest&lt;/code&gt;所有&lt;code&gt;Module&lt;/code&gt;的&lt;code&gt;providers&lt;/code&gt;，对使用了指定装饰器的&lt;code&gt;provider&lt;/code&gt;及其属性做处理&lt;/li&gt;
&lt;li&gt;将处理结果组装为合法的&lt;code&gt;yargs&lt;/code&gt;命令，并且注册至&lt;code&gt;yargs&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;提供&lt;code&gt;entrypoint&lt;/code&gt;，用于上述步骤1和2及命令的执行&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;具体实现可以在&lt;a href=&quot;https://github.com/tashuo/nest-command&quot;&gt;nest-command&lt;/a&gt;项目中查看&lt;/p&gt;
&lt;h3 id=&quot;使用&quot;&gt;&lt;a href=&quot;#使用&quot; class=&quot;headerlink&quot; title=&quot;使用&quot;&gt;&lt;/a&gt;使用&lt;/h3&gt;&lt;p&gt;项目提供了&lt;code&gt;@Command&lt;/code&gt;、&lt;code&gt;@Commands&lt;/code&gt;和&lt;code&gt;@OriginYargsCommand&lt;/code&gt;三个装饰器，分别用于单个命令、多个命令及原生yargs命令的注册.&lt;/p&gt;</summary>
    
    
    
    <category term="typescript" scheme="https://www.aisheishei.com/categories/typescript/"/>
    
    <category term="nestjs" scheme="https://www.aisheishei.com/categories/typescript/nestjs/"/>
    
    
    <category term="npm" scheme="https://www.aisheishei.com/tags/npm/"/>
    
    <category term="jest" scheme="https://www.aisheishei.com/tags/jest/"/>
    
    <category term="javascript" scheme="https://www.aisheishei.com/tags/javascript/"/>
    
    <category term="yargs" scheme="https://www.aisheishei.com/tags/yargs/"/>
    
    <category term="commander" scheme="https://www.aisheishei.com/tags/commander/"/>
    
  </entry>
  
  <entry>
    <title>从零开始编写Nest库</title>
    <link href="https://www.aisheishei.com/2023/04/23/first-nest-library/"/>
    <id>https://www.aisheishei.com/2023/04/23/first-nest-library/</id>
    <published>2023-04-23T10:00:58.000Z</published>
    <updated>2024-12-24T04:50:12.323Z</updated>
    
    
    <summary type="html">&lt;h3 id=&quot;十万个为什么&quot;&gt;&lt;a href=&quot;#十万个为什么&quot; class=&quot;headerlink&quot; title=&quot;十万个为什么&quot;&gt;&lt;/a&gt;十万个为什么&lt;/h3&gt;&lt;p&gt;&lt;code&gt;nest&lt;/code&gt;库是什么？&lt;code&gt;nest&lt;/code&gt;是一个&lt;code&gt;typescript&lt;/code&gt;构建的&lt;code&gt;node&lt;/code&gt;框架，那&lt;code&gt;nest&lt;/code&gt;库可以理解为依赖&lt;code&gt;nest&lt;/code&gt;框架的&lt;code&gt;node&lt;/code&gt;库？&lt;code&gt;node&lt;/code&gt;是一个&lt;code&gt;javascript&lt;/code&gt;服务端的运行环境，那又要怎样用&lt;code&gt;typescript&lt;/code&gt;编写&lt;code&gt;javascript&lt;/code&gt;库呢？做为一只从其他语言(&lt;code&gt;js&lt;/code&gt;几乎零基础只会简单的&lt;code&gt;jQuery&lt;/code&gt;)转来学习&lt;code&gt;nest&lt;/code&gt;的菜鸟刚开始总会在某些时刻冷不丁得被这些概念绕的云里雾里，不过是因为直接跨过&lt;code&gt;js&lt;/code&gt;、&lt;code&gt;node&lt;/code&gt;、&lt;code&gt;ts&lt;/code&gt;直接啃&lt;code&gt;nest&lt;/code&gt;的原因，底层建筑不牢固直接搬砖终究是雾里看花，而从零手撸一个&lt;code&gt;nest&lt;/code&gt;库不妨可以视为一个敲门砖，可以带我们看一探&lt;code&gt;js&lt;/code&gt;世界的冰山一角.&lt;/p&gt;
&lt;h3 id=&quot;撸起袖子开干&quot;&gt;&lt;a href=&quot;#撸起袖子开干&quot; class=&quot;headerlink&quot; title=&quot;撸起袖子开干&quot;&gt;&lt;/a&gt;撸起袖子开干&lt;/h3&gt;&lt;h4 id=&quot;给它一个家&quot;&gt;&lt;a href=&quot;#给它一个家&quot; class=&quot;headerlink&quot; title=&quot;给它一个家&quot;&gt;&lt;/a&gt;给它一个家&lt;/h4&gt;&lt;p&gt;&lt;code&gt;nest&lt;/code&gt;库终究也是一个独立的项目，和其他开源库一样我们使用&lt;code&gt;github&lt;/code&gt;来做版本管理，新建一个空白仓库&lt;code&gt;clone&lt;/code&gt;到本地.&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$: git &lt;span class=&quot;built_in&quot;&gt;clone&lt;/span&gt; https://github.com/tashuo/nestjs-config&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$: &lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; nestjs-config&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h4 id=&quot;给它一支指挥棒&quot;&gt;&lt;a href=&quot;#给它一支指挥棒&quot; class=&quot;headerlink&quot; title=&quot;给它一支指挥棒&quot;&gt;&lt;/a&gt;给它一支指挥棒&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;npm&lt;/code&gt; is the world’s largest software registry. Open source developers from every continent use npm to share and borrow packages, and many organizations use npm to manage private development as well.&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="typescript" scheme="https://www.aisheishei.com/categories/typescript/"/>
    
    <category term="nestjs" scheme="https://www.aisheishei.com/categories/typescript/nestjs/"/>
    
    
    <category term="npm" scheme="https://www.aisheishei.com/tags/npm/"/>
    
    <category term="jest" scheme="https://www.aisheishei.com/tags/jest/"/>
    
    <category term="javascript" scheme="https://www.aisheishei.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>nestjs websocket 实现私聊、系统推送</title>
    <link href="https://www.aisheishei.com/2023/04/14/nestjs-websocket/"/>
    <id>https://www.aisheishei.com/2023/04/14/nestjs-websocket/</id>
    <published>2023-04-14T11:04:24.000Z</published>
    <updated>2024-12-23T02:53:45.290Z</updated>
    
    
    <summary type="html">&lt;h2 id=&quot;Nestjs-websocket开发记录&quot;&gt;&lt;a href=&quot;#Nestjs-websocket开发记录&quot; class=&quot;headerlink&quot; title=&quot;Nestjs websocket开发记录&quot;&gt;&lt;/a&gt;Nestjs websocket开发记录&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://docs.nestjs.com/websockets/gateways&quot;&gt;官方文档&lt;/a&gt;介绍的比较详细了，但实际开发过程中还是遇到了不少问题，在此做一下记录.&lt;/p&gt;
&lt;h2 id=&quot;背景知识&quot;&gt;&lt;a href=&quot;#背景知识&quot; class=&quot;headerlink&quot; title=&quot;背景知识&quot;&gt;&lt;/a&gt;背景知识&lt;/h2&gt;&lt;h3 id=&quot;websocket&quot;&gt;&lt;a href=&quot;#websocket&quot; class=&quot;headerlink&quot; title=&quot;websocket&quot;&gt;&lt;/a&gt;websocket&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API&quot;&gt;https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;流行的websocket库&quot;&gt;&lt;a href=&quot;#流行的websocket库&quot; class=&quot;headerlink&quot; title=&quot;流行的websocket库&quot;&gt;&lt;/a&gt;流行的websocket库&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/websockets/ws&quot;&gt;ws&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/socketio/socket.io&quot;&gt;socket.io&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Nest配套&quot;&gt;&lt;a href=&quot;#Nest配套&quot; class=&quot;headerlink&quot; title=&quot;Nest配套&quot;&gt;&lt;/a&gt;Nest配套&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;In Nest, a gateway is simply a class annotated with @WebSocketGateway() decorator. Technically, gateways are platform-agnostic which makes them compatible with any WebSockets library once an adapter is created. There are two WS platforms supported out-of-the-box: socket.io and ws.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;nest提供了&lt;code&gt;gateway&lt;/code&gt;的概念，&lt;code&gt;gateway&lt;/code&gt;与平台无关，底层可以适配任何websocket库，此处选用更为流行的&lt;code&gt;socket.io&lt;/code&gt;做为示例，而且项目切换驱动的代码改动非常小，即便后面要改为&lt;code&gt;ws&lt;/code&gt;也没有太大负担，架构设计甚是优雅.&lt;/p&gt;
&lt;h2 id=&quot;开发&quot;&gt;&lt;a href=&quot;#开发&quot; class=&quot;headerlink&quot; title=&quot;开发&quot;&gt;&lt;/a&gt;开发&lt;/h2&gt;&lt;h3 id=&quot;安装依赖&quot;&gt;&lt;a href=&quot;#安装依赖&quot; class=&quot;headerlink&quot; title=&quot;安装依赖&quot;&gt;&lt;/a&gt;安装依赖&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ pnpm i --save @nestjs/websockets @nestjs/platform-socket.io socket.io&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;使用&lt;code&gt;ws&lt;/code&gt;库：&lt;/em&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ pnpm i --save @nestjs/websockets @nestjs/platform-ws ws&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="typescript" scheme="https://www.aisheishei.com/categories/typescript/"/>
    
    <category term="nestjs" scheme="https://www.aisheishei.com/categories/typescript/nestjs/"/>
    
    
    <category term="socket.io" scheme="https://www.aisheishei.com/tags/socket-io/"/>
    
    <category term="webscoket" scheme="https://www.aisheishei.com/tags/webscoket/"/>
    
  </entry>
  
  <entry>
    <title>记一次mysql被黑的经历</title>
    <link href="https://www.aisheishei.com/2023/03/17/flarum-mysql-recover/"/>
    <id>https://www.aisheishei.com/2023/03/17/flarum-mysql-recover/</id>
    <published>2023-03-17T15:11:11.000Z</published>
    <updated>2024-12-23T02:53:45.265Z</updated>
    
    
    <summary type="html">&lt;h2 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h2&gt;&lt;p&gt;前段时间用&lt;code&gt;flarum&lt;/code&gt;搭了个论坛，由于docker设置mysql端口对外开放且密码很简单，不出意外中招了:) 一大早有群友找上来说网站又打不开，我收住了即将第五十三次劝她换掉e家宽的冲动，打开网页一看事情没那么简单～&lt;/p&gt;
&lt;h2 id=&quot;中招&quot;&gt;&lt;a href=&quot;#中招&quot; class=&quot;headerlink&quot; title=&quot;中招&quot;&gt;&lt;/a&gt;中招&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://i.328888.xyz/2023/03/17/LGKvq.png&quot; alt=&quot;LGKvq.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;错误日志：这他娘的库子都没了:)&lt;br&gt;&lt;img src=&quot;https://i.328888.xyz/2023/03/17/LGoEN.png&quot; alt=&quot;LGoEN.png&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="php" scheme="https://www.aisheishei.com/categories/php/"/>
    
    <category term="mysql" scheme="https://www.aisheishei.com/categories/php/mysql/"/>
    
    
    <category term="flarum" scheme="https://www.aisheishei.com/tags/flarum/"/>
    
  </entry>
  
  <entry>
    <title>hexo next及github配置</title>
    <link href="https://www.aisheishei.com/2023/01/12/hexo-next/"/>
    <id>https://www.aisheishei.com/2023/01/12/hexo-next/</id>
    <published>2023-01-12T07:56:50.000Z</published>
    <updated>2024-12-23T02:53:45.286Z</updated>
    
    
    <summary type="html">&lt;h3 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h3&gt;&lt;p&gt;之前博客许久未打理，本地的node环境和hexo版本也比较陈旧，删除了github旧仓库重新跑了一遍，做下记录以便日后参考&lt;/p&gt;
&lt;h3 id=&quot;参考文档&quot;&gt;&lt;a href=&quot;#参考文档&quot; class=&quot;headerlink&quot; title=&quot;参考文档&quot;&gt;&lt;/a&gt;参考文档&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://hexo.io/zh-cn/docs/&quot;&gt;hexo文档&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://theme-next.js.org/docs/getting-started/&quot;&gt;next主题文档&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;流程&quot;&gt;&lt;a href=&quot;#流程&quot; class=&quot;headerlink&quot; title=&quot;流程&quot;&gt;&lt;/a&gt;流程&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;安装hexo及项目初始化&lt;/p&gt;
 &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$: npm install -g hexo-cli &lt;span class=&quot;comment&quot;&gt;# 安装hexo&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$: hexo init my_project &lt;span class=&quot;comment&quot;&gt;# 初始化项目&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;项目配置&lt;/p&gt;
&lt;p&gt; &lt;a href=&quot;https://hexo.io/zh-cn/docs/configuration&quot;&gt;配置&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;安装next主题&lt;/p&gt;
&lt;p&gt; &lt;a href=&quot;https://theme-next.js.org/docs/getting-started/&quot;&gt;Getting Started&lt;/a&gt;&lt;/p&gt;
&lt;p&gt; 此处使用git方式下载的包在生成静态文件时index.html中包含模板标签，访问有问题，暂时没找到原因，所以使用了npm方式安装：&lt;/p&gt;
 &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$: &lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; my_project &amp;amp;&amp;amp; npm install hexo-theme-next &lt;span class=&quot;comment&quot;&gt;# 安装next主题&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$: &lt;span class=&quot;built_in&quot;&gt;cp&lt;/span&gt; -rp node_modules/hexo-theme-next themes/next &lt;span class=&quot;comment&quot;&gt;# 此处将npm包拷贝到项目的themes目录，方便主题配置文件的版本管理&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$: npm uninstall hexo-theme-next&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="笔记" scheme="https://www.aisheishei.com/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="hexo" scheme="https://www.aisheishei.com/tags/hexo/"/>
    
    <category term="next" scheme="https://www.aisheishei.com/tags/next/"/>
    
  </entry>
  
  <entry>
    <title>Hyperf db连接池</title>
    <link href="https://www.aisheishei.com/2023/01/08/hyperf-db-connection-pool/"/>
    <id>https://www.aisheishei.com/2023/01/08/hyperf-db-connection-pool/</id>
    <published>2023-01-09T04:47:24.000Z</published>
    <updated>2024-12-23T02:53:45.287Z</updated>
    
    
    <summary type="html">&lt;h3 id=&quot;连接池&quot;&gt;&lt;a href=&quot;#连接池&quot; class=&quot;headerlink&quot; title=&quot;连接池&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://hyperf.wiki/3.0/#/zh-cn/db/quick-start&quot;&gt;连接池&lt;/a&gt;&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/hyperf/database&quot;&gt;hyperf/database&lt;/a&gt; 组件是基于 &lt;a href=&quot;https://github.com/illuminate/database&quot;&gt;illuminate/database&lt;/a&gt; 衍生出来的组件，我们对它进行了一些改造，从设计上是允许用于其它 PHP-FPM 框架或基于 Swoole 的框架中的，而在 Hyperf 里就需要提一下 &lt;a href=&quot;https://github.com/hyperf/db-connection&quot;&gt;hyperf/db-connection&lt;/a&gt; 组件，它基于 &lt;a href=&quot;https://github.com/hyperf/pool&quot;&gt;hyperf/pool&lt;/a&gt; 实现了数据库连接池并对模型进行了新的抽象，以它作为桥梁，Hyperf 才能把数据库组件及事件组件接入进来。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;实现&quot;&gt;&lt;a href=&quot;#实现&quot; class=&quot;headerlink&quot; title=&quot;实现&quot;&gt;&lt;/a&gt;实现&lt;/h3&gt;&lt;p&gt;Hyperf的db使用有两种方式，是否走ORM，ORM会对db查询及响应做多一层封装，底层最终也是通过&lt;code&gt;connection&lt;/code&gt; 发起db请求。&lt;/p&gt;</summary>
    
    
    
    <category term="php" scheme="https://www.aisheishei.com/categories/php/"/>
    
    <category term="hyperf" scheme="https://www.aisheishei.com/categories/php/hyperf/"/>
    
    
    <category term="连接池" scheme="https://www.aisheishei.com/tags/%E8%BF%9E%E6%8E%A5%E6%B1%A0/"/>
    
  </entry>
  
  <entry>
    <title>Laravel跨域处理</title>
    <link href="https://www.aisheishei.com/2020/06/05/laravel-cors/"/>
    <id>https://www.aisheishei.com/2020/06/05/laravel-cors/</id>
    <published>2020-06-05T08:17:50.000Z</published>
    <updated>2024-12-23T02:53:45.288Z</updated>
    
    
    <summary type="html">&lt;h4 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h4&gt;&lt;p&gt;在前后端分离的应用中，需要使用CORS完成跨域访问。在CORS中发送 &lt;code&gt;非简单请求&lt;/code&gt;时，前端会发一个请求方式为OPTIONS的预请求，前端只有收到服务器对这个OPTIONS请求的正确响应，才会发送正常的请求，否则将抛出跨域相关的错误。&lt;/p&gt;
&lt;h4 id=&quot;跨域&quot;&gt;&lt;a href=&quot;#跨域&quot; class=&quot;headerlink&quot; title=&quot;跨域&quot;&gt;&lt;/a&gt;跨域&lt;/h4&gt;&lt;h5 id=&quot;可实现跨域的方式&quot;&gt;&lt;a href=&quot;#可实现跨域的方式&quot; class=&quot;headerlink&quot; title=&quot;可实现跨域的方式&quot;&gt;&lt;/a&gt;可实现跨域的方式&lt;/h5&gt;&lt;ul&gt;
&lt;li&gt;JSONP&lt;/li&gt;
&lt;li&gt;CORS&lt;/li&gt;
&lt;li&gt;Flash&lt;/li&gt;
&lt;li&gt;服务器中转&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;比较常用的是 &lt;code&gt;JSONP&lt;/code&gt;和 &lt;code&gt;CORS&lt;/code&gt;，而后者相对前者来说有更方便实用：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;JSONP&lt;/code&gt;只能实现&lt;code&gt;GET&lt;/code&gt;请求，而&lt;code&gt;CORS&lt;/code&gt;支持所有类型的HTTP请求。&lt;/li&gt;
&lt;li&gt;使用&lt;code&gt;CORS&lt;/code&gt;，开发者可以使用普通的&lt;code&gt;XMLHttpRequest&lt;/code&gt;发起请求和获得数据，比起&lt;code&gt;JSONP&lt;/code&gt;有更好的错误处理。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;此文暂不介绍jsonp&lt;/p&gt;
&lt;h5 id=&quot;CORS&quot;&gt;&lt;a href=&quot;#CORS&quot; class=&quot;headerlink&quot; title=&quot;CORS&quot;&gt;&lt;/a&gt;CORS&lt;/h5&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;CORS&lt;/code&gt;是一种网络浏览器的技术规范，它为Web服务器定义了一种方式，允许网页从不同的域访问其资源。而这种访问是被同源策略所禁止的。&lt;code&gt;CORS&lt;/code&gt;系统定义了一种浏览器和服务器交互的方式来确定是否允许跨域请求。&lt;br&gt;使用 &lt;code&gt;CORS&lt;/code&gt;的方式非常简单，但是需要同时对前端和服务器端做相应处理。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;客户端使用XmlHttpRequest发起Ajax请求，当前绝大部分浏览器已经支持CORS方式，且主流浏览器均提供了对跨域资源共享的支持。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;如上所述，接着只需&lt;strong&gt;在服务端配置可允许跨域的header&lt;/strong&gt;即可:&lt;/p&gt;
&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;# TestController.php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;TestController&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__construct&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 跨域头&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;title function_ invoke__&quot;&gt;header&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&amp;#x27;Access-Control-Allow-Origin: *&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;test&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;#x27;test&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="php" scheme="https://www.aisheishei.com/categories/php/"/>
    
    <category term="laravel" scheme="https://www.aisheishei.com/categories/php/laravel/"/>
    
    
    <category term="跨域" scheme="https://www.aisheishei.com/tags/%E8%B7%A8%E5%9F%9F/"/>
    
    <category term="CORS" scheme="https://www.aisheishei.com/tags/CORS/"/>
    
  </entry>
  
  <entry>
    <title>Go by Example - Sorting</title>
    <link href="https://www.aisheishei.com/2019/04/13/go-by-example-sorting/"/>
    <id>https://www.aisheishei.com/2019/04/13/go-by-example-sorting/</id>
    <published>2019-04-13T10:20:18.000Z</published>
    <updated>2024-12-23T02:53:45.283Z</updated>
    
    
    <summary type="html">&lt;p&gt;翻译自 &lt;a href=&quot;https://gobyexample.com/&quot;&gt;https://gobyexample.com/&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Go by Example&lt;/p&gt;
&lt;p&gt;Go is an open source programming language designed for building simple, fast, and reliable software.&lt;/p&gt;
&lt;p&gt;Go by Example is a hands-on introduction to Go using annotated example programs. Check out the first example or browse the full list below.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;Go-by-Example-Sorting&quot;&gt;&lt;a href=&quot;#Go-by-Example-Sorting&quot; class=&quot;headerlink&quot; title=&quot;Go by Example: Sorting&quot;&gt;&lt;/a&gt;&lt;center&gt;Go by Example: Sorting&lt;/center&gt;&lt;/h2&gt;&lt;p&gt;golang的&lt;code&gt;sort&lt;/code&gt;包可以对内置类型和用户定义的类型进行排序操作，接下来我们先看下内置类型。&lt;/p&gt;</summary>
    
    
    
    <category term="golang" scheme="https://www.aisheishei.com/categories/golang/"/>
    
    <category term="笔记" scheme="https://www.aisheishei.com/categories/golang/%E7%AC%94%E8%AE%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>2018年度总结</title>
    <link href="https://www.aisheishei.com/2019/01/06/2018-summary/"/>
    <id>https://www.aisheishei.com/2019/01/06/2018-summary/</id>
    <published>2019-01-06T11:04:45.000Z</published>
    <updated>2024-12-23T02:53:45.262Z</updated>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;未经审视的生活是不值得过的 - 苏格拉底&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;生命是一团欲望，欲望不能满足便痛苦，满足便无聊，人生就在痛苦和无聊之间摇摆 - 叔本华&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;上周五刚卷铺盖滚出了入职不满四个多月的厂子，如今写起字来不免&lt;strong&gt;悲凉&lt;/strong&gt;，只希望接下来文思泉涌时莫泪洒键盘，笔记本给整坏了，恐怕一时半会都没钱修理了。&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&quot;干过的事儿&quot;&gt;&lt;a href=&quot;#干过的事儿&quot; class=&quot;headerlink&quot; title=&quot;干过的事儿&quot;&gt;&lt;/a&gt;干过的事儿&lt;/h3&gt;&lt;h4 id=&quot;书&quot;&gt;&lt;a href=&quot;#书&quot; class=&quot;headerlink&quot; title=&quot;书&quot;&gt;&lt;/a&gt;书&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/26908213/&quot;&gt;西西弗神话-加缪全集：第五卷&lt;/a&gt; ✭✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/25956992/&quot;&gt;博尔赫斯，口述&lt;/a&gt; ✭✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/25796061/&quot;&gt;杜撰集&lt;/a&gt; ✭✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/5423785/&quot;&gt;千年繁华-京都的街巷人生&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/26270303/&quot;&gt;永恒史&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/25862578/&quot;&gt;解忧杂货店&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/27599965/&quot;&gt;就喜欢你看不惯我又干不掉我的样子3&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/4105446/&quot;&gt;十一种孤独 Eleven Kinds of Loneliness&lt;/a&gt; ✭✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/27200261/&quot;&gt;假面山庄&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/27085746/&quot;&gt;漫长的告别&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/6125543/&quot;&gt;北方的空地&lt;/a&gt; ✭✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/3908240/&quot;&gt;情人&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/1400707/&quot;&gt;广岛之恋&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/27031276/&quot;&gt;再见，宝贝 Farewell, My Lovely&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/26863349/&quot;&gt;湖底女人 The Lady in the Lake&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/6515859/&quot;&gt;傅译巴尔扎克代表作1&lt;/a&gt; ✭✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/6515860/&quot;&gt;傅译巴尔扎克代表作2&lt;/a&gt; ✭✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/6515861/&quot;&gt;傅译巴尔扎克代表作3&lt;/a&gt; ✭✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/26841607/&quot;&gt;高窗 The High Window&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/27614904/&quot;&gt;房思琪的初恋乐园&lt;/a&gt; ✭✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/10555509/&quot;&gt;看不见的城市  Le città invisibili&lt;/a&gt; ✭✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/1858513/&quot;&gt;月亮和六便士&lt;/a&gt; ✭✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/26757680/&quot;&gt;面纱&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/26638213/&quot;&gt;简爱&lt;/a&gt; ✭✭✭✭ &lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/25752284/&quot;&gt;艽野尘梦&lt;/a&gt; ✭✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/4742918/&quot;&gt;1Q84 BOOK 1&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/4885241/&quot;&gt;1Q84 BOOK 2&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/5502995/&quot;&gt;1Q84 BOOK 3&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/24382569/&quot;&gt;一桩事先张扬的凶杀案&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/26892991/&quot;&gt;你的第一本哲学书 What Does it All Mean?&lt;/a&gt; ✭✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/26390842/&quot;&gt;哲学家们都干了些什么&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/3131626/&quot;&gt;荒原狼&lt;/a&gt; ✭✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/3071717/&quot;&gt;爱你就像爱生命&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/1917972/&quot;&gt;在路上 On the Road&lt;/a&gt; ✭✭✭✭&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/5388095/&quot;&gt;三个火枪手&lt;/a&gt; ✭✭✭&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="生活" scheme="https://www.aisheishei.com/categories/life/"/>
    
    
    <category term="生活" scheme="https://www.aisheishei.com/tags/%E7%94%9F%E6%B4%BB/"/>
    
    <category term="广州" scheme="https://www.aisheishei.com/tags/%E5%B9%BF%E5%B7%9E/"/>
    
  </entry>
  
  <entry>
    <title>Go by Example - Stateful Goroutines</title>
    <link href="https://www.aisheishei.com/2018/02/06/go-by-example-stateful-goroutines/"/>
    <id>https://www.aisheishei.com/2018/02/06/go-by-example-stateful-goroutines/</id>
    <published>2018-02-06T07:04:20.000Z</published>
    <updated>2024-12-23T02:53:45.284Z</updated>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;翻译自 &lt;a href=&quot;https://gobyexample.com/&quot;&gt;https://gobyexample.com/&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Go by Example&lt;/p&gt;
&lt;p&gt;Go is an open source</summary>
        
      
    
    
    
    <category term="golang" scheme="https://www.aisheishei.com/categories/golang/"/>
    
    <category term="笔记" scheme="https://www.aisheishei.com/categories/golang/%E7%AC%94%E8%AE%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>Go by Example - Mutexes</title>
    <link href="https://www.aisheishei.com/2017/12/12/go-by-example-mutexes/"/>
    <id>https://www.aisheishei.com/2017/12/12/go-by-example-mutexes/</id>
    <published>2017-12-13T02:37:07.000Z</published>
    <updated>2024-12-23T02:53:45.280Z</updated>
    
    
    <summary type="html">&lt;p&gt;翻译自 &lt;a href=&quot;https://gobyexample.com/&quot;&gt;https://gobyexample.com/&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Go by Example&lt;/p&gt;
&lt;p&gt;Go is an open source programming language designed for building simple, fast, and reliable software.&lt;/p&gt;
&lt;p&gt;Go by Example is a hands-on introduction to Go using annotated example programs. Check out the first example or browse the full list below.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;Go-by-Example-Mutexes&quot;&gt;&lt;a href=&quot;#Go-by-Example-Mutexes&quot; class=&quot;headerlink&quot; title=&quot;Go by Example: Mutexes&quot;&gt;&lt;/a&gt;&lt;center&gt;Go by Example: Mutexes&lt;/center&gt;&lt;/h2&gt;&lt;p&gt;在前面的示例中我们看到如何通过原子操作来管理简单的计数器。对于更复杂的状态，我们可以使用互斥锁在多个goroutine中安全地访问数据。&lt;/p&gt;
&lt;figure class=&quot;highlight golang&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;package&lt;/span&gt; main&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; (&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&amp;quot;fmt&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&amp;quot;math/rand&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&amp;quot;sync&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&amp;quot;sync/atomic&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&amp;quot;time&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 此处状态是一个map&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; state = &lt;span class=&quot;built_in&quot;&gt;make&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;map&lt;/span&gt;[&lt;span class=&quot;type&quot;&gt;int&lt;/span&gt;]&lt;span class=&quot;type&quot;&gt;int&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 初始化锁&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; mutex = &amp;amp;sync.Mutex&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 定义两个变量用于追踪读和写的总次数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; readOps &lt;span class=&quot;type&quot;&gt;uint64&lt;/span&gt; = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; writeOps &lt;span class=&quot;type&quot;&gt;uint64&lt;/span&gt; = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 启动100个goroutines读取状态值，每个goroutine耗时1毫秒&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; r := &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; r &amp;lt; &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;; r++ &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;go&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            total := &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// 随机读取状态的某一个值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// 1、加锁&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// 2、读取&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// 3、解锁&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                key := rand.Intn(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mutex.Lock()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                total += state[key]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mutex.Unlock()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// 次数自增1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                atomic.AddUint64(&amp;amp;readOps, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// 两次读取之间睡眠1毫秒&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                time.Sleep(time.Millisecond)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 同上，启动10个goroutines模拟写操作&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 随机给状态赋值，写操作次数自增1，睡眠1毫秒&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; w := &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; w &amp;lt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;; w++ &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;go&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                key := rand.Intn(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                val := rand.Intn(&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mutex.Lock()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                state[key] = val&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mutex.Unlock()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                atomic.AddUint64(&amp;amp;writeOps, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                time.Sleep(time.Millisecond)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 睡眠一秒等待读写操作&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 打印出读写次数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    time.Sleep(time.Second)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    readOpsFinal := atomic.LoadUint64(&amp;amp;readOps)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fmt.Println(&lt;span class=&quot;string&quot;&gt;&amp;quot;readOps:&amp;quot;&lt;/span&gt;, readOpsFinal)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    writeOpsFinal := atomic.LoadUint64(&amp;amp;writeOps)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fmt.Println(&lt;span class=&quot;string&quot;&gt;&amp;quot;writeOps:&amp;quot;&lt;/span&gt;, writeOpsFinal)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 使用锁取出最后的状态值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    mutex.Lock()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    fmt.Println(&lt;span class=&quot;string&quot;&gt;&amp;quot;state:&amp;quot;&lt;/span&gt;, state)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    mutex.Unlock()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="golang" scheme="https://www.aisheishei.com/categories/golang/"/>
    
    <category term="笔记" scheme="https://www.aisheishei.com/categories/golang/%E7%AC%94%E8%AE%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>Go by Example - Atomic Counters</title>
    <link href="https://www.aisheishei.com/2017/11/28/go-by-example-atomic-counter/"/>
    <id>https://www.aisheishei.com/2017/11/28/go-by-example-atomic-counter/</id>
    <published>2017-11-28T12:54:10.000Z</published>
    <updated>2024-12-23T02:53:45.266Z</updated>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;翻译自 &lt;a href=&quot;https://gobyexample.com/&quot;&gt;https://gobyexample.com/&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Go by Example&lt;/p&gt;
&lt;p&gt;Go is an open source</summary>
        
      
    
    
    
    <category term="golang" scheme="https://www.aisheishei.com/categories/golang/"/>
    
    <category term="笔记" scheme="https://www.aisheishei.com/categories/golang/%E7%AC%94%E8%AE%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>Go by Example - Rate Limiting</title>
    <link href="https://www.aisheishei.com/2017/11/24/go-by-example-rate-limiting/"/>
    <id>https://www.aisheishei.com/2017/11/24/go-by-example-rate-limiting/</id>
    <published>2017-11-24T07:28:43.000Z</published>
    <updated>2024-12-23T02:53:45.282Z</updated>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;翻译自 &lt;a href=&quot;https://gobyexample.com/&quot;&gt;https://gobyexample.com/&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Go by Example&lt;/p&gt;
&lt;p&gt;Go is an open source</summary>
        
      
    
    
    
    <category term="golang" scheme="https://www.aisheishei.com/categories/golang/"/>
    
    <category term="笔记" scheme="https://www.aisheishei.com/categories/golang/%E7%AC%94%E8%AE%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>Go by Example - Worker Pools</title>
    <link href="https://www.aisheishei.com/2017/11/23/go-by-example-worker-pool/"/>
    <id>https://www.aisheishei.com/2017/11/23/go-by-example-worker-pool/</id>
    <published>2017-11-24T04:21:09.000Z</published>
    <updated>2024-12-23T02:53:45.286Z</updated>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;翻译自 &lt;a href=&quot;https://gobyexample.com/&quot;&gt;https://gobyexample.com/&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Go by Example&lt;/p&gt;
&lt;p&gt;Go is an open source</summary>
        
      
    
    
    
    <category term="golang" scheme="https://www.aisheishei.com/categories/golang/"/>
    
    <category term="笔记" scheme="https://www.aisheishei.com/categories/golang/%E7%AC%94%E8%AE%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>Go by Example - Tickers</title>
    <link href="https://www.aisheishei.com/2017/09/05/go-by-example-tikers/"/>
    <id>https://www.aisheishei.com/2017/09/05/go-by-example-tikers/</id>
    <published>2017-09-06T02:50:18.000Z</published>
    <updated>2024-12-23T02:53:45.284Z</updated>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;翻译自 &lt;a href=&quot;https://gobyexample.com/&quot;&gt;https://gobyexample.com/&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Go by Example&lt;/p&gt;
&lt;p&gt;Go is an open source</summary>
        
      
    
    
    
    <category term="golang" scheme="https://www.aisheishei.com/categories/golang/"/>
    
    <category term="笔记" scheme="https://www.aisheishei.com/categories/golang/%E7%AC%94%E8%AE%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>Go by Example - Timers</title>
    <link href="https://www.aisheishei.com/2017/09/05/go-by-example-timer/"/>
    <id>https://www.aisheishei.com/2017/09/05/go-by-example-timer/</id>
    <published>2017-09-06T01:46:27.000Z</published>
    <updated>2024-12-23T02:53:45.285Z</updated>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;翻译自 &lt;a href=&quot;https://gobyexample.com/&quot;&gt;https://gobyexample.com/&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Go by Example&lt;/p&gt;
&lt;p&gt;Go is an open source</summary>
        
      
    
    
    
    <category term="golang" scheme="https://www.aisheishei.com/categories/golang/"/>
    
    <category term="笔记" scheme="https://www.aisheishei.com/categories/golang/%E7%AC%94%E8%AE%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>Go by Example - Range over Channels</title>
    <link href="https://www.aisheishei.com/2017/08/24/go-by-example-range-over-channels/"/>
    <id>https://www.aisheishei.com/2017/08/24/go-by-example-range-over-channels/</id>
    <published>2017-08-25T02:44:04.000Z</published>
    <updated>2024-12-23T02:53:45.282Z</updated>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;翻译自 &lt;a href=&quot;https://gobyexample.com/&quot;&gt;https://gobyexample.com/&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Go by Example&lt;/p&gt;
&lt;p&gt;Go is an open source</summary>
        
      
    
    
    
    <category term="golang" scheme="https://www.aisheishei.com/categories/golang/"/>
    
    <category term="笔记" scheme="https://www.aisheishei.com/categories/golang/%E7%AC%94%E8%AE%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>Go by Example - Closing Channels</title>
    <link href="https://www.aisheishei.com/2017/08/24/go-by-example-closing-channel/"/>
    <id>https://www.aisheishei.com/2017/08/24/go-by-example-closing-channel/</id>
    <published>2017-08-25T01:38:27.000Z</published>
    <updated>2024-12-23T02:53:45.268Z</updated>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;翻译自 &lt;a href=&quot;https://gobyexample.com/&quot;&gt;https://gobyexample.com/&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Go by Example&lt;/p&gt;
&lt;p&gt;Go is an open source</summary>
        
      
    
    
    
    <category term="golang" scheme="https://www.aisheishei.com/categories/golang/"/>
    
    <category term="笔记" scheme="https://www.aisheishei.com/categories/golang/%E7%AC%94%E8%AE%B0/"/>
    
    
  </entry>
  
</feed>
